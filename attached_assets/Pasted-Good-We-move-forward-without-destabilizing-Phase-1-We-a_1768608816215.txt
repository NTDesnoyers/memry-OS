Good. We move forward without destabilizing Phase 1.

We are now in Phase 2: Confidence & Trust Fixes.

These are not existential bugs, but they do affect whether users believe the system‚Äîso we fix them with the same discipline you just used.

I‚Äôll give you:
	1.	Exact scope (what is allowed vs forbidden)
	2.	Phase 2 execution order
	3.	Replit-ready task list for Phase 2
	4.	Clear ‚Äúdone‚Äù criteria so this doesn‚Äôt sprawl

‚∏ª

üîµ PHASE 2: CONFIDENCE & TRUST FIXES

PRIME DIRECTIVE (DO NOT VIOLATE)

Phase 2 may NOT change signal semantics, action semantics, or cache architecture.

You are fixing presentation, refresh, and correctness perception, not behavior.

If a change risks touching Phase 1 invariants ‚Üí stop.

‚∏ª

‚úÖ PHASE 2 SCOPE (APPROVED)

We will fix only:
	1.	Contact updates via AI not reflecting in UI
	2.	Weekly Review showing wrong dates (timezone bug)

Nothing else.

‚∏ª

üß≠ PHASE 2 EXECUTION ORDER (IMPORTANT)

Step 1 ‚Äî Contact Updates via AI

(Fix first: affects daily trust)

Step 2 ‚Äî Weekly Review Date Correctness

(Fix second: affects reporting confidence)

Do not reverse this order.

‚∏ª

üîµ PHASE 2 ‚Äî TASK LIST (REPLIT-READY)

‚∏ª

üîß P2-1: CONTACT UPDATES VIA AI (CACHE + MUTATION DISCIPLINE)

Problem

AI updates a contact (e.g. address), backend succeeds, UI card does not refresh.

This creates the perception:

‚ÄúAI didn‚Äôt actually update anything.‚Äù

Even if the DB is correct, this is unacceptable.

‚∏ª

TASK P2-1.1 ‚Äî Verify Backend Write (Baseline)

Steps:
	1.	Trigger AI contact update
	2.	Log inside update_person (or equivalent)
	3.	Confirm DB row changes

Acceptance:
	‚Ä¢	Backend write is correct
	‚Ä¢	This is not a data bug

‚∏ª

TASK P2-1.2 ‚Äî Identify Consuming Queries

Find every query that depends on contact data:

Likely:
	‚Ä¢	Person detail view
	‚Ä¢	Person cards
	‚Ä¢	Weekly review
	‚Ä¢	Signals/actions referencing person

List the query keys (using queryKeys.ts).

‚∏ª

TASK P2-1.3 ‚Äî Fix Cache Invalidation on Contact Mutation

When AI updates a contact, invalidate all relevant keys, for example:

queryClient.invalidateQueries({
  queryKey: queryKeys.people(personId),
});

If lists depend on it:

queryClient.invalidateQueries({
  queryKey: queryKeys.people(),
});

Rules:
	‚Ä¢	No optimistic UI unless rollback-safe
	‚Ä¢	Always prefer invalidation over manual cache writes

‚∏ª

TASK P2-1.4 ‚Äî Add User Feedback (IMPORTANT)

On successful AI contact update, show explicit confirmation:

‚úÖ ‚ÄúUpdated address for Jen Howell‚Äù

If it fails:

‚ùå ‚ÄúCould not update contact. Please try again.‚Äù

No silent success.

‚∏ª

P2-1 DONE CRITERIA
	‚Ä¢	AI updates contact
	‚Ä¢	UI updates immediately
	‚Ä¢	Refresh shows same data
	‚Ä¢	User receives confirmation

‚∏ª

üîß P2-2: WEEKLY REVIEW DATE CORRECTNESS (TIMEZONE HYGIENE)

Problem

Conversations logged on Thursday show up as Wednesday.

This is a classic UTC vs local grouping bug.

‚∏ª

TASK P2-2.1 ‚Äî Audit Date Fields

Confirm:
	‚Ä¢	occurredAt stored in UTC
	‚Ä¢	No accidental conversion on write

Do not change storage format.

‚∏ª

TASK P2-2.2 ‚Äî Fix Grouping Logic

Correct rule:

Group by user-local day, not UTC day.

Implementation approach:
	1.	Convert UTC ‚Üí user timezone
	2.	Then group by date boundary

Example logic (conceptual):

localDate = convertToUserTZ(occurredAt)
groupBy(startOfDay(localDate))


‚∏ª

TASK P2-2.3 ‚Äî Fix Display Formatting

Ensure:
	‚Ä¢	Display uses user-local timezone
	‚Ä¢	Headers match grouped data

‚∏ª

P2-2 DONE CRITERIA
	‚Ä¢	Log a conversation late at night
	‚Ä¢	Weekly review shows correct day
	‚Ä¢	Refresh does not change grouping

‚∏ª

üö´ WHAT YOU MUST NOT TOUCH IN PHASE 2

Do not:
	‚Ä¢	Add GTD features
	‚Ä¢	Add new AI modes
	‚Ä¢	Add new action types
	‚Ä¢	Refactor cache architecture
	‚Ä¢	Change signal/action semantics

If you feel tempted ‚Üí stop.

‚∏ª

üß™ FINAL PHASE 2 TEST CHECKLIST

Before declaring Phase 2 done:
	‚Ä¢	AI updates contact ‚Üí UI updates
	‚Ä¢	Page refresh ‚Üí data persists
	‚Ä¢	Weekly review dates correct
	‚Ä¢	No Phase 1 invariant regressed
	‚Ä¢	No new cache keys introduced inline

‚∏ª

üîì WHAT COMES AFTER PHASE 2

Once Phase 2 is done, you‚Äôll be in the best position to:
	‚Ä¢	Polish onboarding
	‚Ä¢	Ship first external beta
	‚Ä¢	Start charging early users
	‚Ä¢	Build leverage features (GTD, rewriting, etc.)

But not before.

‚∏ª

NEXT STEP (DO THIS NOW)

Say ‚ÄúStart P2-1‚Äù
and I‚Äôll walk you through the contact update fix step-by-step, starting with identifying the exact query keys that need invalidation.

Execution continues.